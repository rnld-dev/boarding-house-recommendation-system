"0","# Load libraries"
"0","library(cluster)"
"0","library(dplyr)"
"0",""
"0","# Scaling parameters (pastikan production adalah data pelatihan)"
"0","scaling_params <- list(center = c(Harga = mean(df$Harga), Luas.Kamar = mean(df$Luas.Kamar), UPN = mean(df$UPN)), "
"0","                       scale = c(Harga = sd(df$Harga), Luas.Kamar = sd(df$Luas.Kamar), UPN = sd(df$UPN)))"
"0",""
"0","# Scale function"
"0","scale_data <- function(data, scaling_params) {"
"0","  data <- data %>%"
"0","    mutate(Harga.Scale = (Harga - scaling_params$center[""Harga""]) / scaling_params$scale[""Harga""],"
"0","           Luas.Kamar.Scale = (Luas.Kamar - scaling_params$center[""Luas.Kamar""]) /  scaling_params$scale[""Luas.Kamar""],"
"0","           UPN.Scale = (UPN - scaling_params$center[""UPN""]) / scaling_params$scale[""UPN""],"
"0","           Jenis = as.factor(Jenis),"
"0","           Listrik = as.factor(Listrik),"
"0","           K.Mandi.Dalam = as.factor(K.Mandi.Dalam),"
"0","           AC = as.factor(AC))"
"0","  return(data)"
"0","}"
"0",""
"0","# Data baru"
"0","new_data <- data.frame(Harga = 1500000, "
"0","                       Luas.Kamar = 20, "
"0","                       UPN = 1.2, "
"0","                       Jenis = ""Campur"", "
"0","                       Listrik = ""Termasuk listrik"", "
"0","                       K.Mandi.Dalam = ""Yes"", "
"0","                       AC = ""No"")"
"0",""
"0","# Scale the new data using the provided scaling parameters"
"0","new_data_scaled <- scale_data(new_data, scaling_params)"
"0",""
"0","# Gabungkan data pelatihan dengan data baru"
"0","df_combined <- bind_rows(df, new_data_scaled) "
"0",""
"0","# Kolom yang digunakan dalam model"
"0","selected_col <- c(""Harga.Scale"", ""Luas.Kamar.Scale"", ""UPN.Scale"", ""Jenis"", ""Listrik"", ""K.Mandi.Dalam"", ""AC"")"
"0",""
"0","# Gower distance untuk data baru"
"0","df_gower_combined <- daisy(df_combined[, selected_col], metric = ""gower"")"
"0",""
"0","# Convert Gower distance object to matrix"
"0","df_gower_combined_matrix <- as.matrix(df_gower_combined)"
"0",""
"0","# Jarak antara data baru dan data pelatihan"
"0","gower_distance_new <- df_gower_combined_matrix[nrow(df_combined), 1:nrow(df)]"
"0",""
"0","# Menentukan klaster data baru"
"0","cluster_new_data <- pam_fit2$clustering[which.min(gower_distance_new)]"
"0",""
"0","# Filter data pelatihan yang berada dalam klaster yang sama dengan data baru"
"0","same_cluster_indices <- which(pam_fit2$clustering == cluster_new_data)"
"0","gower_distance_same_cluster <- gower_distance_new[same_cluster_indices]"
"0",""
"0","# Menampilkan 20 kos terdekat dalam klaster yang sama"
"0","nearest_kos_indices <- same_cluster_indices[order(gower_distance_same_cluster)[1:20]]"
"0","nearest_kos <- df[nearest_kos_indices, ]"
"0",""
"0","# Membuat dataframe hasil dengan jarak Gower"
"0","results <- nearest_kos %>%"
"0","  mutate(Gower_Distance = gower_distance_same_cluster[order(gower_distance_same_cluster)[1:20]]) %>%"
"0","  select(Harga, Luas.Kamar, UPN, Jenis, Listrik, K.Mandi.Dalam, AC, cluster, Gower_Distance)"
"0",""
"0","# Hasil klasterisasi"
"0","print(paste(""Klaster data baru:"", cluster_new_data))"
"1","[1]"
"1"," ""Klaster data baru: 1"""
"1","
"
"0","print(""20 kos terdekat dalam klaster yang sama beserta jarak Gower:"")"
"1","[1]"
"1"," ""20 kos terdekat dalam klaster yang sama beserta jarak Gower:"""
"1","
"
"0","print(results)"
